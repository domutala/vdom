!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.vdom=t():e.vdom=t()}(self,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>n});const r=(e,t={},r=[])=>((t instanceof Node||"string"==typeof t||Array.isArray(t))&&(r=t,t={}),{tagName:e,attrs:t.attrs||{},on:t.on||{},children:r});class n{el;vnode;data={};$createElement=r;$h=r;render(){return this.$h("span")}create=()=>this.render();mount=e=>{this.data=new Proxy(this.data,{get:(e,t)=>Reflect.get(e,t),set:(e,t,r)=>(e[t]=r,this.rebuild(),!0)}),this.vnode=this.create();const t=this.$render(this.vnode);return this.el=this.$mount(t,e),this.el};rebuild=()=>{const e=this.create(),t=this.$diff(this.vnode,e);this.el=t(this.el),this.vnode=e};setClass=e=>{const t=[];if("object"==typeof e)for(const r of Object.keys(e))e[r]&&t.push(r);else t.push(e);return t.join(" ")};$renderElem=e=>{const t=document.createElement(e.tagName);for(const[r,n]of Object.entries(e.attrs))"model"===r&&["input","select","textarea"].includes(e.tagName)?(t.addEventListener("input",(e=>{let r=(e.srcElement||e.target).value;"number"==t.getAttribute("type")&&(r=Number(r)),this.data[n]=r})),t.setAttribute("value",this.data[n])):t.setAttribute(r,n);for(const[r,n]of Object.entries(e.on))t.addEventListener(r,n);for(const r of e.children)t.appendChild(this.$render(r));return t};$render=e=>e?"string"==typeof e?document.createTextNode(e):this.$renderElem(e):document.createComment(" ");$mount=(e,t)=>(t.replaceWith(e),e);$diffZip=(e,t)=>{const r=[];for(let n=0;n<Math.max(e.length,t.length);n++)r.push([e[n],t[n]]);return r};$diffAttrs=(e,t)=>{const r=[];for(const[e,n]of Object.entries(t))r.push((t=>(t.setAttribute(e,n),t)));for(const n in e)n in t||r.push((e=>(e.removeAttribute(n),e)));return e=>{for(const t of r)t(e)}};$diffChildren=(e,t)=>{const r=[];e.forEach(((e,n)=>{r.push(this.$diff(e,t[n]))}));const n=[];for(const r of t.slice(e.length))n.push((e=>(e.appendChild(this.$render(r)),e)));return e=>{for(const[t,n]of this.$diffZip(r,e.childNodes))t(n);for(const t of n)t(e);return e}};$diff=(e,t)=>{if(void 0===t)return e=>{const t=document.createComment(" ");return e.replaceWith(t),t};if("string"==typeof e||"string"==typeof t)return e!==t?e=>{const r=this.$render(t);return e.replaceWith(r),r}:e=>{};if(e.tagName!==t.tagName)return e=>{const r=this.$render(t);return e.replaceWith(r),r};const r=this.$diffAttrs(e.attrs,t.attrs),n=this.$diffChildren(e.children,t.children);return e=>(r(e),n(e),e)}}return t})()));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SUFBSyxNQUFNQyxLQUFvQkwsRUFBYU0sTUFBTVAsRUFBYVAsUUFDN0RZLEVBQWtCekMsTUFBTW1CLElBQ3RCQSxFQUFNSCxZQUFZbkMsS0FBS1UsUUFBUW1ELElBQ3hCdkIsS0FJWCxPQUFReUIsSUFDTixJQUFLLE1BQU9sRCxFQUFPcUIsS0FBVWxDLEtBQUt5QyxTQUNoQ2dCLEVBQ0FNLEVBQVFDLFlBRVJuRCxFQUFNcUIsR0FHUixJQUFLLE1BQU1yQixLQUFTK0MsRUFDbEIvQyxFQUFNa0QsR0FHUixPQUFPQSxJQUlRakQsTUFBUSxDQUFDbUQsRUFBaUJDLEtBQzNDLFFBQWlCQyxJQUFiRCxFQUNGLE9BQVE1QixJQUNOLE1BQU04QixFQUFXN0MsU0FBU2MsY0FBYyxLQUV4QyxPQURBQyxFQUFNRSxZQUFZNEIsR0FDWEEsR0FJWCxHQUF3QixpQkFBYkgsR0FBNkMsaUJBQWJDLEVBQ3pDLE9BQUlELElBQWFDLEVBQ1A1QixJQUNOLE1BQU04QixFQUFXcEUsS0FBS1UsUUFBUXdELEdBRTlCLE9BREE1QixFQUFNRSxZQUFZNEIsR0FDWEEsR0FJRDlCLE1BSVosR0FBSTJCLEVBQVNqRixVQUFZa0YsRUFBU2xGLFFBQ2hDLE9BQVFzRCxJQUNOLE1BQU04QixFQUFXcEUsS0FBS1UsUUFBUXdELEdBRTlCLE9BREE1QixFQUFNRSxZQUFZNEIsR0FDWEEsR0FJWCxNQUFNQyxFQUFhckUsS0FBS2lELFdBQVdnQixFQUFTM0UsTUFBTzRFLEVBQVM1RSxPQUN0RGdGLEVBQWdCdEUsS0FBS3NELGNBQ3pCVyxFQUFTL0UsU0FDVGdGLEVBQVNoRixVQUdYLE9BQVFvRCxJQUNOK0IsRUFBVy9CLEdBQ1hnQyxFQUFjaEMsR0FDUEEsSSIsInNvdXJjZXMiOlsid2VicGFjazovL3Zkb20vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL3Zkb20vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdmRvbS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdmRvbS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3Zkb20vd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly92ZG9tLy4vc3JjL2NyZWF0ZUVsZW1lbnQudHMiLCJ3ZWJwYWNrOi8vdmRvbS8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXSwgZmFjdG9yeSk7XG5cdGVsc2UgaWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKVxuXHRcdGV4cG9ydHNbXCJ2ZG9tXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcInZkb21cIl0gPSBmYWN0b3J5KCk7XG59KShzZWxmLCAoKSA9PiB7XG5yZXR1cm4gIiwiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJjb25zdCBmbiA9IChcbiAgdGFnTmFtZTogc3RyaW5nLFxuICBvcHRpb25zOiB7XG4gICAgYXR0cnM/OiB7IFtzdHJpbmc6IHN0cmluZ106IGFueSB9O1xuICAgIG9uPzogeyBbc3RyaW5nOiBzdHJpbmddOiAoZTogYW55KSA9PiBhbnkgfTtcbiAgfSA9IHt9LFxuICBjaGlsZHJlbjogYW55ID0gW11cbikgPT4ge1xuICBpZiAoXG4gICAgb3B0aW9ucyBpbnN0YW5jZW9mIE5vZGUgfHxcbiAgICB0eXBlb2Ygb3B0aW9ucyA9PSBcInN0cmluZ1wiIHx8XG4gICAgQXJyYXkuaXNBcnJheShvcHRpb25zKVxuICApIHtcbiAgICBjaGlsZHJlbiA9IG9wdGlvbnM7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgY29uc3QgYXR0cnMgPSBvcHRpb25zLmF0dHJzIHx8IHt9O1xuICBjb25zdCBvbiA9IG9wdGlvbnMub24gfHwge307XG5cbiAgcmV0dXJuIHtcbiAgICB0YWdOYW1lLFxuICAgIGF0dHJzLFxuICAgIG9uLFxuICAgIGNoaWxkcmVuLFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZm47XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gXCIuLi90eXBpbmdzXCI7XG5pbXBvcnQgY3JlYXRlRWxlbWVudCBmcm9tIFwiLi9jcmVhdGVFbGVtZW50XCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwcCB7XG4gIGVsITogQ29tbWVudCB8IFRleHQgfCBIVE1MRWxlbWVudDtcbiAgdm5vZGUhOiBWTm9kZTtcblxuICBkYXRhOiB7IFtrZXk6IHN0cmluZ106IGFueSB9ID0ge307XG5cbiAgcmVhZG9ubHkgJGNyZWF0ZUVsZW1lbnQgPSBjcmVhdGVFbGVtZW50O1xuICByZWFkb25seSAkaCA9IGNyZWF0ZUVsZW1lbnQ7XG5cbiAgcmVuZGVyKCk6IFZOb2RlIHtcbiAgICByZXR1cm4gdGhpcy4kaChcInNwYW5cIik7XG4gIH1cblxuICBwcml2YXRlIHJlYWRvbmx5IGNyZWF0ZSA9ICgpID0+IHtcbiAgICByZXR1cm4gdGhpcy5yZW5kZXIoKTtcbiAgfTtcblxuICBwdWJsaWMgcmVhZG9ubHkgbW91bnQgPSAocGFyZW50OiBIVE1MRWxlbWVudCkgPT4ge1xuICAgIHRoaXMuZGF0YSA9IG5ldyBQcm94eSh0aGlzLmRhdGEsIHtcbiAgICAgIGdldChjaWJsZTogYW55LCBwcm9wOiBzdHJpbmcpIHtcbiAgICAgICAgcmV0dXJuIFJlZmxlY3QuZ2V0KGNpYmxlLCBwcm9wKTtcbiAgICAgIH0sXG4gICAgICBzZXQ6IChvYmo6IGFueSwgcHJvcDogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7XG4gICAgICAgIG9ialtwcm9wXSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnJlYnVpbGQoKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgdGhpcy52bm9kZSA9IHRoaXMuY3JlYXRlKCk7XG4gICAgY29uc3QgJGVsID0gdGhpcy4kcmVuZGVyKHRoaXMudm5vZGUpO1xuICAgIHRoaXMuZWwgPSB0aGlzLiRtb3VudCgkZWwsIHBhcmVudCk7XG5cbiAgICByZXR1cm4gdGhpcy5lbDtcbiAgfTtcblxuICBwcml2YXRlIHJlYWRvbmx5IHJlYnVpbGQgPSAoKSA9PiB7XG4gICAgY29uc3Qgdk5ld0FwcCA9IHRoaXMuY3JlYXRlKCk7XG4gICAgY29uc3QgcGF0Y2ggPSB0aGlzLiRkaWZmKHRoaXMudm5vZGUsIHZOZXdBcHApO1xuICAgIHRoaXMuZWwgPSBwYXRjaCh0aGlzLmVsIGFzIEhUTUxFbGVtZW50KSBhcyBIVE1MRWxlbWVudDtcbiAgICB0aGlzLnZub2RlID0gdk5ld0FwcDtcbiAgfTtcblxuICBzZXRDbGFzcyA9ICh2OiBhbnkpID0+IHtcbiAgICBjb25zdCBfY2xhc3M6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAodHlwZW9mIHYgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKHYpKSB7XG4gICAgICAgIGlmICh2W2tleV0pIF9jbGFzcy5wdXNoKGtleSk7XG4gICAgICB9XG4gICAgfSBlbHNlIF9jbGFzcy5wdXNoKHYpO1xuXG4gICAgcmV0dXJuIF9jbGFzcy5qb2luKFwiIFwiKTtcbiAgfTtcblxuICAvLyByZW5kZXJcbiAgcHJvdGVjdGVkIHJlYWRvbmx5ICRyZW5kZXJFbGVtID0gKHZOb2RlOiBWTm9kZSkgPT4ge1xuICAgIGNvbnN0ICRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodk5vZGUudGFnTmFtZSk7XG5cbiAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyh2Tm9kZS5hdHRycykpIHtcbiAgICAgIGlmIChcbiAgICAgICAgayA9PT0gXCJtb2RlbFwiICYmXG4gICAgICAgIFtcImlucHV0XCIsIFwic2VsZWN0XCIsIFwidGV4dGFyZWFcIl0uaW5jbHVkZXModk5vZGUudGFnTmFtZSlcbiAgICAgICkge1xuICAgICAgICAkZWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCB0YXJnZXQgPSBlLnNyY0VsZW1lbnQgfHwgZS50YXJnZXQ7XG4gICAgICAgICAgbGV0IHZhbHVlID0gdGFyZ2V0LnZhbHVlO1xuXG4gICAgICAgICAgaWYgKCRlbC5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpID09IFwibnVtYmVyXCIpIHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgICB0aGlzLmRhdGFbdl0gPSB2YWx1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGVsLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIHRoaXMuZGF0YVt2XSk7XG4gICAgICB9IGVsc2UgJGVsLnNldEF0dHJpYnV0ZShrLCB2KTtcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IFtrLCB2XSBvZiBPYmplY3QuZW50cmllcyh2Tm9kZS5vbikpIHtcbiAgICAgICRlbC5hZGRFdmVudExpc3RlbmVyKGssIHYpO1xuICAgIH1cblxuICAgIGZvciAoY29uc3QgY2hpbGQgb2Ygdk5vZGUuY2hpbGRyZW4pICRlbC5hcHBlbmRDaGlsZCh0aGlzLiRyZW5kZXIoY2hpbGQpKTtcblxuICAgIHJldHVybiAkZWw7XG4gIH07XG5cbiAgcHJvdGVjdGVkIHJlYWRvbmx5ICRyZW5kZXIgPSAodk5vZGU6IFZOb2RlKSA9PiB7XG4gICAgaWYgKCF2Tm9kZSkgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoXCIgXCIpO1xuICAgIGlmICh0eXBlb2Ygdk5vZGUgPT09IFwic3RyaW5nXCIpIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh2Tm9kZSk7XG4gICAgcmV0dXJuIHRoaXMuJHJlbmRlckVsZW0odk5vZGUpO1xuICB9O1xuXG4gIC8vIG1vdW50XG4gIHByb3RlY3RlZCByZWFkb25seSAkbW91bnQgPSAoXG4gICAgJG5vZGU6IEhUTUxFbGVtZW50IHwgVGV4dCB8IENvbW1lbnQsXG4gICAgJHRhcmdldDogTm9kZVxuICApID0+IHtcbiAgICAoJHRhcmdldCBhcyBhbnkpLnJlcGxhY2VXaXRoKCRub2RlKTtcbiAgICByZXR1cm4gJG5vZGU7XG4gIH07XG5cbiAgLy8gZGlmZlxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgJGRpZmZaaXAgPSAoeHM6IGFueSwgeXM6IGFueSkgPT4ge1xuICAgIGNvbnN0IHppcHBlZCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTWF0aC5tYXgoeHMubGVuZ3RoLCB5cy5sZW5ndGgpOyBpKyspIHtcbiAgICAgIHppcHBlZC5wdXNoKFt4c1tpXSwgeXNbaV1dKTtcbiAgICB9XG4gICAgcmV0dXJuIHppcHBlZDtcbiAgfTtcblxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgJGRpZmZBdHRycyA9IChcbiAgICBvbGRBdHRyczogeyBba2V5OiBzdHJpbmddOiBhbnkgfSxcbiAgICBuZXdBdHRyczogeyBba2V5OiBzdHJpbmddOiBhbnkgfVxuICApID0+IHtcbiAgICBjb25zdCBwYXRjaGVzOiBhbnlbXSA9IFtdO1xuXG4gICAgLy8gc2V0IG5ldyBhdHRyaWJ1dGVzXG4gICAgZm9yIChjb25zdCBbaywgdl0gb2YgT2JqZWN0LmVudHJpZXMobmV3QXR0cnMpKSB7XG4gICAgICBwYXRjaGVzLnB1c2goKCRub2RlOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgICAkbm9kZS5zZXRBdHRyaWJ1dGUoaywgdik7XG4gICAgICAgIHJldHVybiAkbm9kZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIHJlbW92ZSBvbGQgYXR0cmlidXRlc1xuICAgIGZvciAoY29uc3QgayBpbiBvbGRBdHRycykge1xuICAgICAgaWYgKCEoayBpbiBuZXdBdHRycykpIHtcbiAgICAgICAgcGF0Y2hlcy5wdXNoKCgkbm9kZTogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAkbm9kZS5yZW1vdmVBdHRyaWJ1dGUoayk7XG4gICAgICAgICAgcmV0dXJuICRub2RlO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gKCRub2RlOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgZm9yIChjb25zdCBwYXRjaCBvZiBwYXRjaGVzKSB7XG4gICAgICAgIHBhdGNoKCRub2RlKTtcbiAgICAgIH1cbiAgICB9O1xuICB9O1xuXG4gIHByb3RlY3RlZCByZWFkb25seSAkZGlmZkNoaWxkcmVuID0gKFxuICAgIG9sZFZDaGlsZHJlbjogVk5vZGVbXSxcbiAgICBuZXdWQ2hpbGRyZW46IFZOb2RlW11cbiAgKSA9PiB7XG4gICAgY29uc3QgY2hpbGRQYXRjaGVzOiBhbnlbXSA9IFtdO1xuICAgIG9sZFZDaGlsZHJlbi5mb3JFYWNoKChvbGRWQ2hpbGQsIGkpID0+IHtcbiAgICAgIGNoaWxkUGF0Y2hlcy5wdXNoKHRoaXMuJGRpZmYob2xkVkNoaWxkLCBuZXdWQ2hpbGRyZW5baV0pKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IGFkZGl0aW9uYWxQYXRjaGVzOiBhbnlbXSA9IFtdO1xuICAgIGZvciAoY29uc3QgYWRkaXRpb25hbFZDaGlsZCBvZiBuZXdWQ2hpbGRyZW4uc2xpY2Uob2xkVkNoaWxkcmVuLmxlbmd0aCkpIHtcbiAgICAgIGFkZGl0aW9uYWxQYXRjaGVzLnB1c2goKCRub2RlOiBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgICAkbm9kZS5hcHBlbmRDaGlsZCh0aGlzLiRyZW5kZXIoYWRkaXRpb25hbFZDaGlsZCkpO1xuICAgICAgICByZXR1cm4gJG5vZGU7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gKCRwYXJlbnQ6IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgICBmb3IgKGNvbnN0IFtwYXRjaCwgY2hpbGRdIG9mIHRoaXMuJGRpZmZaaXAoXG4gICAgICAgIGNoaWxkUGF0Y2hlcyxcbiAgICAgICAgJHBhcmVudC5jaGlsZE5vZGVzXG4gICAgICApKSB7XG4gICAgICAgIHBhdGNoKGNoaWxkKTtcbiAgICAgIH1cblxuICAgICAgZm9yIChjb25zdCBwYXRjaCBvZiBhZGRpdGlvbmFsUGF0Y2hlcykge1xuICAgICAgICBwYXRjaCgkcGFyZW50KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICRwYXJlbnQ7XG4gICAgfTtcbiAgfTtcblxuICBwcm90ZWN0ZWQgcmVhZG9ubHkgJGRpZmYgPSAodk9sZE5vZGU6IFZOb2RlLCB2TmV3Tm9kZTogVk5vZGUpID0+IHtcbiAgICBpZiAodk5ld05vZGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuICgkbm9kZTogVGV4dCB8IEhUTUxFbGVtZW50KSA9PiB7XG4gICAgICAgIGNvbnN0ICRuZXdOb2RlID0gZG9jdW1lbnQuY3JlYXRlQ29tbWVudChcIiBcIik7XG4gICAgICAgICRub2RlLnJlcGxhY2VXaXRoKCRuZXdOb2RlKTtcbiAgICAgICAgcmV0dXJuICRuZXdOb2RlO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAodHlwZW9mIHZPbGROb2RlID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiB2TmV3Tm9kZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgaWYgKHZPbGROb2RlICE9PSB2TmV3Tm9kZSkge1xuICAgICAgICByZXR1cm4gKCRub2RlOiBUZXh0IHwgSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgICAgICBjb25zdCAkbmV3Tm9kZSA9IHRoaXMuJHJlbmRlcih2TmV3Tm9kZSk7XG4gICAgICAgICAgJG5vZGUucmVwbGFjZVdpdGgoJG5ld05vZGUpO1xuICAgICAgICAgIHJldHVybiAkbmV3Tm9kZTtcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnNcbiAgICAgICAgcmV0dXJuICgkbm9kZTogVGV4dCB8IEhUTUxFbGVtZW50KSA9PiB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHZPbGROb2RlLnRhZ05hbWUgIT09IHZOZXdOb2RlLnRhZ05hbWUpIHtcbiAgICAgIHJldHVybiAoJG5vZGU6IFRleHQgfCBIVE1MRWxlbWVudCkgPT4ge1xuICAgICAgICBjb25zdCAkbmV3Tm9kZSA9IHRoaXMuJHJlbmRlcih2TmV3Tm9kZSk7XG4gICAgICAgICRub2RlLnJlcGxhY2VXaXRoKCRuZXdOb2RlKTtcbiAgICAgICAgcmV0dXJuICRuZXdOb2RlO1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBwYXRjaEF0dHJzID0gdGhpcy4kZGlmZkF0dHJzKHZPbGROb2RlLmF0dHJzLCB2TmV3Tm9kZS5hdHRycyk7XG4gICAgY29uc3QgcGF0Y2hDaGlsZHJlbiA9IHRoaXMuJGRpZmZDaGlsZHJlbihcbiAgICAgIHZPbGROb2RlLmNoaWxkcmVuLFxuICAgICAgdk5ld05vZGUuY2hpbGRyZW5cbiAgICApO1xuXG4gICAgcmV0dXJuICgkbm9kZTogSFRNTEVsZW1lbnQpID0+IHtcbiAgICAgIHBhdGNoQXR0cnMoJG5vZGUpO1xuICAgICAgcGF0Y2hDaGlsZHJlbigkbm9kZSk7XG4gICAgICByZXR1cm4gJG5vZGU7XG4gICAgfTtcbiAgfTtcbiAgLy8gZW5kIGRpZmZcbn1cbiJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJzZWxmIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0YWdOYW1lIiwib3B0aW9ucyIsImNoaWxkcmVuIiwiTm9kZSIsIkFycmF5IiwiaXNBcnJheSIsImF0dHJzIiwib24iLCJBcHAiLCJlbCIsInZub2RlIiwiZGF0YSIsIiRjcmVhdGVFbGVtZW50IiwiY3JlYXRlRWxlbWVudCIsIiRoIiwicmVuZGVyIiwidGhpcyIsImNyZWF0ZSIsIm1vdW50IiwicGFyZW50IiwiUHJveHkiLCJjaWJsZSIsIlJlZmxlY3QiLCJzZXQiLCJyZWJ1aWxkIiwiJGVsIiwiJHJlbmRlciIsIiRtb3VudCIsInZOZXdBcHAiLCJwYXRjaCIsIiRkaWZmIiwic2V0Q2xhc3MiLCJ2IiwiX2NsYXNzIiwia2V5cyIsInB1c2giLCJqb2luIiwiJHJlbmRlckVsZW0iLCJ2Tm9kZSIsImRvY3VtZW50IiwiayIsImVudHJpZXMiLCJpbmNsdWRlcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwic3JjRWxlbWVudCIsInRhcmdldCIsImdldEF0dHJpYnV0ZSIsIk51bWJlciIsInNldEF0dHJpYnV0ZSIsImNoaWxkIiwiYXBwZW5kQ2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsImNyZWF0ZUNvbW1lbnQiLCIkbm9kZSIsIiR0YXJnZXQiLCJyZXBsYWNlV2l0aCIsIiRkaWZmWmlwIiwieHMiLCJ5cyIsInppcHBlZCIsImkiLCJNYXRoIiwibWF4IiwibGVuZ3RoIiwiJGRpZmZBdHRycyIsIm9sZEF0dHJzIiwibmV3QXR0cnMiLCJwYXRjaGVzIiwicmVtb3ZlQXR0cmlidXRlIiwiJGRpZmZDaGlsZHJlbiIsIm9sZFZDaGlsZHJlbiIsIm5ld1ZDaGlsZHJlbiIsImNoaWxkUGF0Y2hlcyIsImZvckVhY2giLCJvbGRWQ2hpbGQiLCJhZGRpdGlvbmFsUGF0Y2hlcyIsImFkZGl0aW9uYWxWQ2hpbGQiLCJzbGljZSIsIiRwYXJlbnQiLCJjaGlsZE5vZGVzIiwidk9sZE5vZGUiLCJ2TmV3Tm9kZSIsInVuZGVmaW5lZCIsIiRuZXdOb2RlIiwicGF0Y2hBdHRycyIsInBhdGNoQ2hpbGRyZW4iXSwic291cmNlUm9vdCI6IiJ9